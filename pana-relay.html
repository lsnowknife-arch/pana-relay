<!DOCTYPE html>
<html lang="en">
<!-- 
    ORIGINAL CREATOR: Pana Ngwenya
    SYSTEM: Self-Contained Cross-Tab Text Relay
    DATE: January 19, 2026
    SECURITY: No backend, No external links, No persistence.
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pana Secure Relay</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0f0f0f; color: #e0e0e0; display: flex; flex-direction: column; height: 100vh; margin: 0; padding: 20px; box-sizing: border-box; }
        #chat-window { flex-grow: 1; border: 1px solid #222; border-radius: 12px; overflow-y: auto; padding: 15px; background: #161616; margin-bottom: 15px; box-shadow: inset 0 2px 10px rgba(0,0,0,0.5); }
        .message { background: #252525; border-left: 4px solid #00d4ff; padding: 12px; margin: 10px 0; border-radius: 6px; cursor: pointer; transition: all 0.2s; position: relative; }
        .message:hover { background: #303030; transform: translateX(5px); }
        .message::after { content: 'Click to burn'; position: absolute; right: 10px; bottom: 5px; font-size: 0.7em; color: #555; opacity: 0; transition: 0.2s; }
        .message:hover::after { opacity: 1; }
        .message-meta { font-size: 0.75em; color: #00d4ff; font-weight: bold; margin-bottom: 4px; display: block; }
        .input-area { display: flex; gap: 10px; background: #161616; padding: 10px; border-radius: 8px; }
        input { flex-grow: 1; padding: 12px; border: 1px solid #333; border-radius: 6px; background: #000; color: #fff; outline: none; }
        button { padding: 12px 25px; background: #00d4ff; color: #000; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; }
        button:hover { background: #0099ff; }
    </style>
</head>
<body>

    <header style="margin-bottom: 10px;">
        <h2 style="margin: 0; color: #00d4ff;">Pana Secure Relay</h2>
        <p style="font-size: 0.85em; color: #777;">Single-file P2P relay. Messages are cleared on click or refresh.</p>
    </header>

    <div id="chat-window"></div>

    <div class="input-area">
        <input type="text" id="msg-input" placeholder="Write a message..." autocomplete="off">
        <button onclick="sendText()">SEND</button>
    </div>

    <!-- 
        THE INVISIBLE BRIDGE 
        The 'src' below is the 'relay.html' code encoded into a Data URI.
        This allows the same-origin bypass while remaining in a single file.
    -->
    <iframe id="relay-bridge" style="display:none;" 
        src="data:text/html;base64,PGh0bWw+PHNjcmlwdD4KICBjb25zdCBiYyA9IG5ldyBCcm9hZGNhc3RDaGFubmVsKCdwYW5hX3JlbGF5X25ldHdvcmsnKTsKICBiYy5vbm1lc3NhZ2UgPSAoZSkgPT4geyB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKGUuZGF0YSwgIioiKTsgfTsKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIChlKSA9PiB7IGJjLnBvc3RNZXNzYWdlKGUuZGF0YSk7IH0pOwo8L3NjcmlwdD48L2h0bWw+">
    </iframe>

    <script>
        const chatWindow = document.getElementById('chat-window');
        const input = document.getElementById('msg-input');
        const bridge = document.getElementById('relay-bridge');

        // Receive messages from the encoded bridge
        window.addEventListener('message', (event) => {
            if (event.data && typeof event.data === 'string') {
                renderMessage(event.data, "Received");
            }
        });

        function sendText() {
            const text = input.value.trim();
            if (text !== "") {
                // Send text to the invisible bridge
                bridge.contentWindow.postMessage(text, "*");
                // Render on your own screen
                renderMessage(text, "You");
                input.value = "";
            }
        }

        function renderMessage(text, sender) {
            const div = document.createElement('div');
            div.className = 'message';
            const timestamp = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            div.innerHTML = `<span class="message-meta">${sender} â€¢ ${timestamp}</span> ${text}`;
            
            // "Burn on Click" Logic
            div.onclick = function() {
                this.style.transform = 'scale(0.9)';
                this.style.opacity = '0';
                setTimeout(() => this.remove(), 200);
            };

            chatWindow.appendChild(div);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        // Enter key support
        input.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendText(); });
    </script>
</body>
</html>
